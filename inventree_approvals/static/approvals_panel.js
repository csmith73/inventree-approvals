const Z="0.7.0";var o=(e=>(e.api_server_info="",e.user_list="user/",e.user_set_password="user/:id/set-password/",e.user_me="user/me/",e.user_profile="user/profile/",e.user_roles="user/roles/",e.user_token="user/token/",e.user_tokens="user/tokens/",e.user_simple_login="email/generate/",e.user_reset="auth/v1/auth/password/request",e.user_reset_set="auth/v1/auth/password/reset",e.auth_pwd_change="auth/v1/account/password/change",e.auth_login="auth/v1/auth/login",e.auth_login_2fa="auth/v1/auth/2fa/authenticate",e.auth_session="auth/v1/auth/session",e.auth_signup="auth/v1/auth/signup",e.auth_authenticators="auth/v1/account/authenticators",e.auth_recovery="auth/v1/account/authenticators/recovery-codes",e.auth_mfa_reauthenticate="auth/v1/auth/2fa/reauthenticate",e.auth_totp="auth/v1/account/authenticators/totp",e.auth_trust="auth/v1/auth/2fa/trust",e.auth_reauthenticate="auth/v1/auth/reauthenticate",e.auth_email="auth/v1/account/email",e.auth_email_verify="auth/v1/auth/email/verify",e.auth_providers="auth/v1/account/providers",e.auth_provider_redirect="auth/v1/auth/provider/redirect",e.auth_config="auth/v1/config",e.currency_list="currency/exchange/",e.currency_refresh="currency/refresh/",e.all_units="units/all/",e.task_overview="background-task/",e.task_pending_list="background-task/pending/",e.task_scheduled_list="background-task/scheduled/",e.task_failed_list="background-task/failed/",e.api_search="search/",e.settings_global_list="settings/global/",e.settings_user_list="settings/user/",e.news="news/",e.global_status="generic/status/",e.custom_state_list="generic/status/custom/",e.version="version/",e.license="license/",e.group_list="user/group/",e.owner_list="user/owner/",e.ruleset_list="user/ruleset/",e.content_type_list="contenttype/",e.icons="icons/",e.selectionlist_list="selection/",e.selectionlist_detail="selection/:id/",e.barcode="barcode/",e.barcode_history="barcode/history/",e.barcode_link="barcode/link/",e.barcode_unlink="barcode/unlink/",e.barcode_generate="barcode/generate/",e.data_output="data-output/",e.import_session_list="importer/session/",e.import_session_accept_fields="importer/session/:id/accept_fields/",e.import_session_accept_rows="importer/session/:id/accept_rows/",e.import_session_column_mapping_list="importer/column-mapping/",e.import_session_row_list="importer/row/",e.notifications_list="notifications/",e.notifications_readall="notifications/readall/",e.build_order_list="build/",e.build_order_issue="build/:id/issue/",e.build_order_cancel="build/:id/cancel/",e.build_order_hold="build/:id/hold/",e.build_order_complete="build/:id/finish/",e.build_output_complete="build/:id/complete/",e.build_output_create="build/:id/create-output/",e.build_output_scrap="build/:id/scrap-outputs/",e.build_output_delete="build/:id/delete-outputs/",e.build_order_auto_allocate="build/:id/auto-allocate/",e.build_order_allocate="build/:id/allocate/",e.build_order_consume="build/:id/consume/",e.build_order_deallocate="build/:id/unallocate/",e.build_line_list="build/line/",e.build_item_list="build/item/",e.bom_list="bom/",e.bom_item_validate="bom/:id/validate/",e.bom_validate="part/:id/bom-validate/",e.bom_substitute_list="bom/substitute/",e.part_list="part/",e.part_parameter_list="part/parameter/",e.part_parameter_template_list="part/parameter/template/",e.part_thumbs_list="part/thumbs/",e.part_pricing="part/:id/pricing/",e.part_requirements="part/:id/requirements/",e.part_serial_numbers="part/:id/serial-numbers/",e.part_scheduling="part/:id/scheduling/",e.part_pricing_internal="part/internal-price/",e.part_pricing_sale="part/sale-price/",e.part_stocktake_list="part/stocktake/",e.category_list="part/category/",e.category_tree="part/category/tree/",e.category_parameter_list="part/category/parameters/",e.related_part_list="part/related/",e.part_test_template_list="part/test-template/",e.company_list="company/",e.contact_list="company/contact/",e.address_list="company/address/",e.supplier_part_list="company/part/",e.supplier_part_pricing_list="company/price-break/",e.manufacturer_part_list="company/part/manufacturer/",e.manufacturer_part_parameter_list="company/part/manufacturer/parameter/",e.stock_location_list="stock/location/",e.stock_location_type_list="stock/location-type/",e.stock_location_tree="stock/location/tree/",e.stock_item_list="stock/",e.stock_tracking_list="stock/track/",e.stock_test_result_list="stock/test/",e.stock_transfer="stock/transfer/",e.stock_remove="stock/remove/",e.stock_return="stock/return/",e.stock_add="stock/add/",e.stock_count="stock/count/",e.stock_change_status="stock/change_status/",e.stock_merge="stock/merge/",e.stock_assign="stock/assign/",e.stock_status="stock/status/",e.stock_install="stock/:id/install/",e.stock_uninstall="stock/:id/uninstall/",e.stock_serialize="stock/:id/serialize/",e.stock_serial_info="stock/:id/serial-numbers/",e.generate_batch_code="generate/batch-code/",e.generate_serial_number="generate/serial-number/",e.purchase_order_list="order/po/",e.purchase_order_issue="order/po/:id/issue/",e.purchase_order_hold="order/po/:id/hold/",e.purchase_order_cancel="order/po/:id/cancel/",e.purchase_order_complete="order/po/:id/complete/",e.purchase_order_line_list="order/po-line/",e.purchase_order_extra_line_list="order/po-extra-line/",e.purchase_order_receive="order/po/:id/receive/",e.sales_order_list="order/so/",e.sales_order_issue="order/so/:id/issue/",e.sales_order_hold="order/so/:id/hold/",e.sales_order_cancel="order/so/:id/cancel/",e.sales_order_ship="order/so/:id/ship/",e.sales_order_complete="order/so/:id/complete/",e.sales_order_allocate="order/so/:id/allocate/",e.sales_order_allocate_serials="order/so/:id/allocate-serials/",e.sales_order_line_list="order/so-line/",e.sales_order_extra_line_list="order/so-extra-line/",e.sales_order_allocation_list="order/so-allocation/",e.sales_order_shipment_list="order/so/shipment/",e.sales_order_shipment_complete="order/so/shipment/:id/ship/",e.return_order_list="order/ro/",e.return_order_issue="order/ro/:id/issue/",e.return_order_hold="order/ro/:id/hold/",e.return_order_cancel="order/ro/:id/cancel/",e.return_order_complete="order/ro/:id/complete/",e.return_order_receive="order/ro/:id/receive/",e.return_order_line_list="order/ro-line/",e.return_order_extra_line_list="order/ro-extra-line/",e.label_list="label/template/",e.label_print="label/print/",e.report_list="report/template/",e.report_print="report/print/",e.report_snippet="report/snippet/",e.report_asset="report/asset/",e.plugin_list="plugins/",e.plugin_setting_list="plugins/:plugin/settings/",e.plugin_user_setting_list="plugins/:plugin/user-settings/",e.plugin_registry_status="plugins/status/",e.plugin_install="plugins/install/",e.plugin_reload="plugins/reload/",e.plugin_activate="plugins/:key/activate/",e.plugin_uninstall="plugins/:key/uninstall/",e.plugin_admin="plugins/:key/admin/",e.plugin_ui_features_list="plugins/ui/features/:feature_type/",e.plugin_locate_item="locate/",e.machine_types_list="machine/types/",e.machine_driver_list="machine/drivers/",e.machine_registry_status="machine/status/",e.machine_list="machine/",e.machine_restart="machine/:machine/restart/",e.machine_setting_list="machine/:machine/settings/",e.machine_setting_detail="machine/:machine/settings/:config_type/",e.attachment_list="attachment/",e.error_report_list="error-report/",e.project_code_list="project-code/",e.custom_unit_list="units/",e.notes_image_upload="notes-image-upload/",e.email_list="admin/email/",e.email_test="admin/email/test/",e.config_list="admin/config/",e))(o||{});window.LinguiCore.i18n;window.LinguiCore.i18n;o.part_list,o.part_parameter_template_list,o.part_test_template_list,o.supplier_part_list,o.manufacturer_part_list,o.category_list,o.stock_item_list,o.stock_location_list,o.stock_location_type_list,o.stock_tracking_list,o.build_order_list,o.build_line_list,o.build_item_list,o.company_list,o.project_code_list,o.purchase_order_list,o.purchase_order_line_list,o.sales_order_list,o.sales_order_shipment_list,o.return_order_list,o.return_order_line_list,o.address_list,o.contact_list,o.owner_list,o.user_list,o.group_list,o.import_session_list,o.label_list,o.report_list,o.plugin_list,o.content_type_list,o.selectionlist_list,o.error_report_list;function Q(e){var n;const a=((n=e?.version)==null?void 0:n.inventree)||"";Z!=a&&console.info(`Plugin version mismatch! Expected version ${Z}, got ${a}`)}var D={exports:{}},q={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E;function he(){if(E)return q;E=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(s,c,l){var i=null;if(l!==void 0&&(i=""+l),c.key!==void 0&&(i=""+c.key),"key"in c){l={};for(var u in c)u!=="key"&&(l[u]=c[u])}else l=c;return c=l.ref,{$$typeof:e,type:s,key:i,ref:c!==void 0?c:null,props:l}}return q.Fragment=n,q.jsx=a,q.jsxs=a,q}var K;function ge(){return K||(K=1,D.exports=he()),D.exports}ge();window.MantineCore.ActionIcon;window.MantineCore.Group;window.MantineCore.Tooltip;/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var we={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=window.React.forwardRef,O=window.React.createElement,C=(e,n,a,s)=>{const c=pe(({color:l="currentColor",size:i=24,stroke:u=2,title:r,className:h,children:t,...m},p)=>O("svg",{ref:p,...we[e],width:i,height:i,className:["tabler-icon",`tabler-icon-${n}`,h].join(" "),strokeWidth:u,stroke:l,...m},[r&&O("title",{key:"svg-title"},r),...s.map(([v,f])=>O(v,f)),...Array.isArray(t)?t:[t]]));return c.displayName=`${a}`,c};/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]];C("outline","plus","Plus",Re);window.MantineCore.ActionIcon;window.MantineCore.Menu;window.MantineCore.Tooltip;window.MantineCore.Progress;window.MantineCore.Stack;window.MantineCore.Text;window.React.useMemo;window.LinguiCore.i18n;window.MantineCore.Badge;window.MantineCore.Skeleton;window.React.useState;window.React.useRef;window.React.useCallback;window.React.useEffect;/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]];C("outline","search","Search",ve);window.LinguiCore.i18n;window.MantineCore.CloseButton;window.MantineCore.TextInput;window.React.useEffect;window.React.useState;/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]];C("outline","arrow-right","ArrowRight",fe);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]];C("outline","copy","Copy",ke);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]];C("outline","edit","Edit",ye);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]];C("outline","trash","Trash",be);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 10l4 4m0 -4l-4 4",key:"svg-1"}]];C("outline","circle-x","CircleX",Ce);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]];C("outline","dots","Dots",Me);window.LinguiCore.i18n;window.MantineCore.ActionIcon;window.MantineCore.Menu;window.MantineCore.Tooltip;window.React.useMemo;window.React.useState;/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=window.React.forwardRef,I=window.React.createElement,z=(e,n,a,s)=>{const c=$e(({color:l="currentColor",size:i=24,stroke:u=2,title:r,className:h,children:t,...m},p)=>I("svg",{ref:p,...Te[e],width:i,height:i,className:["tabler-icon",`tabler-icon-${n}`,h].join(" "),strokeWidth:u,stroke:l,...m},[r&&I("title",{key:"svg-title"},r),...s.map(([v,f])=>I(v,f)),...Array.isArray(t)?t:[t]]));return c.displayName=`${a}`,c};/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 8v4",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]],le=z("outline","alert-circle","AlertCircle",xe);/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]],j=z("outline","alert-triangle","AlertTriangle",Se);/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]],A=z("outline","check","Check",ze);/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M9 11l3 3l8 -8",key:"svg-0"}],["path",{d:"M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9",key:"svg-1"}]],oe=z("outline","checkbox","Checkbox",qe);/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2",key:"svg-1"}],["path",{d:"M9 17h6",key:"svg-2"}],["path",{d:"M9 13h6",key:"svg-3"}]],Le=z("outline","file-description","FileDescription",Ne);/**
 * @license @tabler/icons-react v3.36.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]],Be=z("outline","x","X",je),Pe=window.MantineCore.Badge,d=window.MantineCore.Table,N=window.MantineCore.Text,De=window.MantineCore.Stack;function Oe(e){switch(e){case"approved":return{color:"green",label:"âœ“ Approved"};case"rejected":return{color:"red",label:"âœ— Rejected"};case"pending":return{color:"yellow",label:"â³ Pending"};default:return{color:"gray",label:e}}}function ee(e){if(!e)return"-";try{return new Date(e).toLocaleString()}catch{return e}}function Ie({approvals:e}){if(e.length===0)return React.createElement(N,{c:"dimmed",fs:"italic",size:"sm"},"No approvals yet");const n=e.map((a,s)=>{const{color:c,label:l}=Oe(a.status);return React.createElement(d.Tr,{key:s},React.createElement(d.Td,null,"Level ",a.level),React.createElement(d.Td,null,React.createElement(Pe,{color:c,variant:"filled",size:"sm"},l)),React.createElement(d.Td,null,a.requested_by_name||"-"),React.createElement(d.Td,null,a.status==="pending"?a.requested_approver_name||"Any":a.actual_approver_name||"-"),React.createElement(d.Td,null,React.createElement(N,{size:"xs",c:"dimmed"},ee(a.requested_at))),React.createElement(d.Td,null,React.createElement(N,{size:"xs",c:"dimmed"},a.status!=="pending"?ee(a.decided_at):"-")),React.createElement(d.Td,null,React.createElement(N,{size:"xs",style:{whiteSpace:"pre-wrap"}},a.notes||"-")))});return React.createElement(De,{gap:"xs"},React.createElement(N,{fw:500,size:"sm"},"Approval History"),React.createElement(d,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0},React.createElement(d.Thead,null,React.createElement(d.Tr,null,React.createElement(d.Th,null,"Level"),React.createElement(d.Th,null,"Status"),React.createElement(d.Th,null,"Requested By"),React.createElement(d.Th,null,"Approver"),React.createElement(d.Th,null,"Requested"),React.createElement(d.Th,null,"Decided"),React.createElement(d.Th,null,"Notes"))),React.createElement(d.Tbody,null,n)))}const b=window.React.useState,ce=window.React.useEffect,ne=window.MantineCore.Modal,B=window.MantineCore.Button,Fe=window.MantineCore.Select,se=window.MantineCore.Textarea,ie=window.MantineCore.Stack,ue=window.MantineCore.Group,de=window.MantineCore.LoadingOverlay,_e=window.MantineCore.Alert;function Ge({opened:e,onClose:n,onSuccess:a,orderId:s,pluginSlug:c,isHighValue:l,context:i}){const[u,r]=b(!1),[h,t]=b(null),[m,p]=b([]),[v,f]=b(null),[M,k]=b("");ce(()=>{e&&(t(null),R())},[e]);async function R(){try{const _=l?"?is_high_value=true":"",me=(await i.api?.get(`plugin/${c}/users/${_}`))?.data;p(me?.results||[])}catch(_){console.error("Failed to load approvers:",_),p([])}}async function T(){r(!0),t(null);try{const P=(await i.api?.post(`plugin/${c}/po/${s}/request/`,{approver_id:v,notes:M}))?.data;P?.success?(k(""),f(null),a(),n()):t(P?.error||"Failed to request approval")}catch(_){t(_ instanceof Error?_.message:"An error occurred")}finally{r(!1)}}const y=[...l?[]:[{value:"",label:"-- Any Available Approver --"}],...l?[]:[{value:"teams_channel",label:"ðŸ“¢ Teams Purchasing Channel"}],...m.map(_=>({value:String(_.id),label:`${_.full_name} (${_.username})`}))];return React.createElement(ne,{opened:e,onClose:n,title:"Request Approval",size:"md"},React.createElement(de,{visible:u}),React.createElement(ie,{gap:"md"},h&&React.createElement(_e,{color:"red",icon:React.createElement(le,{size:16})},h),React.createElement(Fe,{label:"Select Approver (optional)",placeholder:"Select an approver",data:y,value:v,onChange:f,clearable:!0}),React.createElement(se,{label:"Notes (optional)",placeholder:"Add any notes for the approver",value:M,onChange:_=>k(_.currentTarget.value),rows:3}),React.createElement(ue,{justify:"flex-end",gap:"sm"},React.createElement(B,{variant:"default",onClick:n},"Cancel"),React.createElement(B,{onClick:T,loading:u},"Submit Request"))))}function te({opened:e,onClose:n,onSuccess:a,orderId:s,pluginSlug:c,isApprove:l,context:i}){const[u,r]=b(!1),[h,t]=b(null),[m,p]=b("");ce(()=>{e&&(t(null),p(""))},[e]);async function v(){r(!0),t(null);try{const R=l?"approve":"reject",y=(await i.api?.post(`plugin/${c}/po/${s}/${R}/`,{notes:m}))?.data;y?.success?(p(""),a(),n()):t(y?.error||`Failed to ${l?"approve":"reject"}`)}catch(R){t(R instanceof Error?R.message:"An error occurred")}finally{r(!1)}}const f=l?"Approve Request":"Reject Request",M=l?"green":"red",k=l?"Approve":"Reject";return React.createElement(ne,{opened:e,onClose:n,title:f,size:"md"},React.createElement(de,{visible:u}),React.createElement(ie,{gap:"md"},h&&React.createElement(_e,{color:"red",icon:React.createElement(le,{size:16})},h),React.createElement(se,{label:"Notes (optional)",placeholder:`Add any notes for ${l?"approving":"rejecting"} this request`,value:m,onChange:R=>p(R.currentTarget.value),rows:3}),React.createElement(ue,{justify:"flex-end",gap:"sm"},React.createElement(B,{variant:"default",onClick:n},"Cancel"),React.createElement(B,{color:M,onClick:v,loading:u},k))))}const $=window.React.useState,We=window.React.useEffect,re=window.React.useCallback,ae=window.MantineCore.Stack,F=window.MantineCore.Group,He=window.MantineCore.Badge,G=window.MantineCore.Button,W=window.MantineCore.Alert,Je=window.MantineCore.Loader,Ve=window.MantineCore.Paper,L=window.MantineCore.Text;function Xe({context:e}){const n=e.context,a=n?.order_id||e.id,s=n?.plugin_slug||"approvals",[c,l]=$(!0),[i,u]=$(null),[r,h]=$(null),[t,m]=$(!1),[p,v]=$(!1),[f,M]=$(!1),k=re(async()=>{if(!a){u("No order ID provided"),l(!1);return}try{l(!0),u(null);const _=await e.api?.get(`plugin/${s}/po/${a}/status/`);h(_?.data)}catch(_){u(_ instanceof Error?_.message:"Failed to load approval status")}finally{l(!1)}},[a,s,e.api]);We(()=>{k()},[k]);const R=re(()=>{k()},[k]);if(c&&!r)return React.createElement(ae,{align:"center",p:"md"},React.createElement(Je,{size:"md"}),React.createElement(L,{size:"sm",c:"dimmed"},"Loading approval status..."));if(i&&!r)return React.createElement(W,{color:"red",title:"Error",icon:React.createElement(j,{size:16})},i);if(!r)return React.createElement(W,{color:"yellow",title:"No Data"},"Unable to load approval status");let T,y;return r.is_fully_approved?(T="green",y="âœ“ Approved"):r.has_pending?(T="yellow",y=`${r.approved_count}/${r.total_required} (Pending)`):(T="blue",y=`${r.approved_count}/${r.total_required}`),React.createElement(ae,{gap:"md",p:"md"},React.createElement(F,{justify:"space-between",align:"center"},React.createElement(L,{fw:600,size:"lg"},"Approval Status"),React.createElement(He,{color:T,variant:"filled",size:"lg"},y)),r.is_high_value&&React.createElement(W,{color:"orange",icon:React.createElement(j,{size:16}),title:"High Value Order"},"This order requires approval from a senior approver"),React.createElement(Ie,{approvals:r.approvals}),React.createElement(F,{gap:"sm"},r.can_request_approval&&React.createElement(G,{leftSection:React.createElement(Le,{size:16}),onClick:()=>m(!0)},"Request Approval"),r.user_can_approve&&React.createElement(React.Fragment,null,React.createElement(G,{color:"green",leftSection:React.createElement(A,{size:16}),onClick:()=>v(!0)},"Approve"),React.createElement(G,{color:"red",leftSection:React.createElement(Be,{size:16}),onClick:()=>M(!0)},"Reject")),r.is_fully_approved&&React.createElement(Ve,{withBorder:!0,p:"sm",bg:"green.0"},React.createElement(F,{gap:"xs"},React.createElement(A,{size:16,color:"green"}),React.createElement(L,{size:"sm",c:"green.8",fw:500},"Order can now be placed")))),!r.can_request_approval&&!r.user_can_approve&&!r.is_fully_approved&&React.createElement(L,{size:"sm",c:"dimmed"},r.can_request_reason||r.user_can_approve_reason||"Waiting for approval action"),React.createElement(Ge,{opened:t,onClose:()=>m(!1),onSuccess:R,orderId:a,pluginSlug:s,isHighValue:r.is_high_value,context:e}),React.createElement(te,{opened:p,onClose:()=>v(!1),onSuccess:R,orderId:a,pluginSlug:s,isApprove:!0,context:e}),React.createElement(te,{opened:f,onClose:()=>M(!1),onSuccess:R,orderId:a,pluginSlug:s,isApprove:!1,context:e}))}const H=window.React.useState,Ye=window.React.useEffect,Ue=window.React.useCallback,J=window.MantineCore.Stack,Qe=window.MantineCore.Group,Ze=window.MantineCore.Badge,Ee=window.MantineCore.Loader,x=window.MantineCore.Text,Ke=window.MantineCore.Anchor,g=window.MantineCore.Table,V=window.MantineCore.Center,Ae=window.MantineCore.Title;function et({context:e}){const n=e.context?.plugin_slug||"approvals",[a,s]=H(!0),[c,l]=H(null),[i,u]=H([]),r=Ue(async()=>{try{s(!0),l(null);const m=(await e.api?.get(`plugin/${n}/pending/`))?.data;u(m?.results||[])}catch(t){l(t instanceof Error?t.message:"Failed to load pending approvals")}finally{s(!1)}},[n,e.api]);if(Ye(()=>{r()},[r]),a)return React.createElement(V,{p:"md",h:"100%"},React.createElement(Ee,{size:"sm"}));if(c)return React.createElement(V,{p:"md",h:"100%"},React.createElement(J,{align:"center",gap:"xs"},React.createElement(j,{size:24,color:"red"}),React.createElement(x,{size:"sm",c:"red"},c)));if(i.length===0)return React.createElement(V,{p:"md",h:"100%"},React.createElement(J,{align:"center",gap:"xs"},React.createElement(oe,{size:32,color:"gray"}),React.createElement(x,{size:"sm",c:"dimmed"},"No pending approvals")));const h=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString()}catch{return t}};return React.createElement(J,{gap:"xs",p:"xs",h:"100%",style:{overflow:"auto"}},React.createElement(Ae,{order:4},"POs Needing Your Approval"),React.createElement(g,{striped:!0,highlightOnHover:!0,withTableBorder:!0},React.createElement(g.Thead,null,React.createElement(g.Tr,null,React.createElement(g.Th,null,"Reference"),React.createElement(g.Th,null,"Supplier"),React.createElement(g.Th,null,"Total"),React.createElement(g.Th,null,"Requested By"),React.createElement(g.Th,null,"Date"))),React.createElement(g.Tbody,null,i.map(t=>React.createElement(g.Tr,{key:t.order_id},React.createElement(g.Td,null,React.createElement(Qe,{gap:"xs"},React.createElement(Ke,{href:t.url,size:"sm",fw:500},t.order_reference),t.is_high_value&&React.createElement(Ze,{size:"xs",color:"orange",variant:"light"},"High Value"))),React.createElement(g.Td,null,React.createElement(x,{size:"sm"},t.supplier||"-")),React.createElement(g.Td,null,React.createElement(x,{size:"sm"},t.order_total||"-")),React.createElement(g.Td,null,React.createElement(x,{size:"sm"},t.requested_by||"-")),React.createElement(g.Td,null,React.createElement(x,{size:"sm",c:"dimmed"},h(t.requested_at))))))))}const X=window.React.useState,tt=window.React.useEffect,rt=window.React.useCallback,Y=window.MantineCore.Stack,at=window.MantineCore.Group,lt=window.MantineCore.Loader,S=window.MantineCore.Text,ot=window.MantineCore.Anchor,w=window.MantineCore.Table,U=window.MantineCore.Center,ct=window.MantineCore.Title;function nt({context:e}){const n=e.context?.plugin_slug||"approvals",[a,s]=X(!0),[c,l]=X(null),[i,u]=X([]),r=rt(async()=>{try{s(!0),l(null);const m=(await e.api?.get(`plugin/${n}/pending-any-approver/`))?.data;u(m?.results||[])}catch(t){l(t instanceof Error?t.message:"Failed to load pending approvals")}finally{s(!1)}},[n,e.api]);if(tt(()=>{r()},[r]),a)return React.createElement(U,{p:"md",h:"100%"},React.createElement(lt,{size:"sm"}));if(c)return React.createElement(U,{p:"md",h:"100%"},React.createElement(Y,{align:"center",gap:"xs"},React.createElement(j,{size:24,color:"red"}),React.createElement(S,{size:"sm",c:"red"},c)));if(i.length===0)return React.createElement(U,{p:"md",h:"100%"},React.createElement(Y,{align:"center",gap:"xs"},React.createElement(oe,{size:32,color:"gray"}),React.createElement(S,{size:"sm",c:"dimmed"},"No pending approvals")));const h=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString()}catch{return t}};return React.createElement(Y,{gap:"xs",p:"xs",h:"100%",style:{overflow:"auto"}},React.createElement(ct,{order:4},"Pending Approvals Any Approver"),React.createElement(w,{striped:!0,highlightOnHover:!0,withTableBorder:!0},React.createElement(w.Thead,null,React.createElement(w.Tr,null,React.createElement(w.Th,null,"Reference"),React.createElement(w.Th,null,"Supplier"),React.createElement(w.Th,null,"Total"),React.createElement(w.Th,null,"Requested By"),React.createElement(w.Th,null,"Date"))),React.createElement(w.Tbody,null,i.map(t=>React.createElement(w.Tr,{key:t.order_id},React.createElement(w.Td,null,React.createElement(at,{gap:"xs"},React.createElement(ot,{href:t.url,size:"sm",fw:500},t.order_reference))),React.createElement(w.Td,null,React.createElement(S,{size:"sm"},t.supplier||"-")),React.createElement(w.Td,null,React.createElement(S,{size:"sm"},t.order_total||"-")),React.createElement(w.Td,null,React.createElement(S,{size:"sm"},t.requested_by||"-")),React.createElement(w.Td,null,React.createElement(S,{size:"sm",c:"dimmed"},h(t.requested_at))))))))}function st(e){return Q(e),React.createElement(Xe,{context:e})}function it(e){return Q(e),React.createElement(et,{context:e})}function ut(e){return Q(e),React.createElement(nt,{context:e})}function dt(e){return e.model!=="purchaseorder"}export{dt as isPanelHidden,ut as renderAnyApproverWidget,it as renderDashboardWidget,st as renderPanel};
//# sourceMappingURL=approvals_panel.js.map
